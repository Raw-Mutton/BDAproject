---
title: "Bayesian Data Analysis Project"
subtitle: "Body fat"
author: Veikka Niemi, Anton Aaltio
format:
  html:
    toc: true
    code-tools: true
    code-line-numbers: true
    number-sections: true
    mainfont: Georgia, serif
    page-layout: article
  pdf:  
    geometry:
    - left=1cm,top=1cm,bottom=1cm,right=7cm
    number-sections: true
    code-annotations: none
editor: source
---

:::: {.content-hidden when-format="pdf"}
::: {.callout-warning collapse=false}
 
## Setup


*This block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission.*
**Make sure that this does not get displayed in the PDF!**

The following loads several needed packages:

```{r}
#| label: imports
library(bayesplot)
library(cmdstanr)
library(dplyr)
library(ggplot2)
library(ggdist) # for stat_dotsinterval
library(posterior)
library(brms)
# Globally specfiy cmdstan backend for brms
options(brms.backend="cmdstanr")
# Tell brms to cache results if possible
options(brms.file_refit="on_change")

# Set more readable themes with bigger font for plotting packages
ggplot2::theme_set(theme_minimal(base_size = 14))
bayesplot::bayesplot_theme_set(theme_minimal(base_size = 14))
```

:::
::::

# Introduction

## Motivation

## Problem description

Body fat percentage = Proportion of fat tissue in body

Predicting body fat percentage

## Main modeling idea

- In addition showing some illustrative figure is recommended

# Methods

## Data description

- Provide information where the data was obtained, and if it has been previously used in some online case study and how your analysis differs from the existing analyses

(Hy√∂dyllinen paperi: Roger W. Johnson (1996), "Fitting Percentage of Body Fat to Simple Body Measurements", Journal of Statistics Education.)

The bodyfat dataset has underwater weighted densities and circumference measurements from 10 body parts measured from 252 men as well as age, weight and height measurements. Using these measurements, the dataset also has body fat percentage estimates for the corresponding individuals.

```{r}
data <- read.csv("bodyfat.csv")
head(data, n=3)
```

The data is originally from a study by Penrose et al.(1985)[^1]. They body fat percentage is calculated as:

$$
\text{Body fat-\%} = \frac{457}{D} - 414.2,
$$

where $D$ is body density. This formula comes from an article by Siri(1956)[^2].




The bodyfat dataset was obtained from [Kaggle.com](https://www.kaggle.com/datasets/fedesoriano/body-fat-prediction-dataset/). It is widely available online and can also be downloaded from multiple R packages. Since the dataset is so widely available, many analyses have been done using it. However, most case studies ???.

## Model description

- At least 2 models

- Informative or weakly informative priors, and justification of the choice of these priors

# Results ?

- brms, rstanarm, or Stan code

- How the MCMC inference was run, that is, what options were used. A good option is to show the command you ran, and a textual explanation of the choice of options

- Convergence diagnostics and what can be interpreted from them, **for all models**
  - Rhat, ESS, divergences
  
  - What was done to improve the model if the checks indicated misspecification. **For all models**
  
- **Bonus:** Predictive performance assessment if applicable (e.g. classification accuracy) and evaluation of practical usefulness of the accuracy, **for all models**

- Sensitivity analysis wrt. prior choices, **for all models**

- Model comparison (LOO-CV)

# Discussion/ Conclusions ?

- Discussion of issues and potential improvements

- Conclusion what was learned from the data analysis

# Self reflection

- What did the group learn while making the project

# Footnotes/ References

[^1]: Penrose, K.W., Nelson, A.G. and Fisher, A.G., 1985. Generalized body composition prediction equation for men using simple measurement techniques. Medicine & Science in Sports & Exercise, 17(2), p.189.

[^2]: Siri, W.E., 1956. The gross composition of the body. In Advances in biological and medical physics (Vol. 4, pp. 239-280). Elsevier.
